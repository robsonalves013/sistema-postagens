{% extends "base.html" %}

{% block title %}Dashboard - Sistema de Postagens Foguete Express ðŸš€{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1><i class="bi bi-speedometer2"></i> Dashboard - {{ data_hoje }}</h1>
        <p class="text-muted">Controle diÃ¡rio dos dois postos de postagem</p>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card stats-card posto-1">
            <div class="card-body">
                <h5 class="card-title"><i class="bi bi-building"></i> Shopping BolÃ­via</h5>
                <div class="row">
                    <div class="col-6">
                        <h3>{{ resumo_posto1.total_postagens }}</h3>
                        <small>Total de Postagens</small>
                    </div>
                    <div class="col-6">
                        <h3>R$ {{ "%.2f"|format(resumo_posto1.total_valor) }}</h3>
                        <small>Valor Total</small>
                    </div>
                </div>
                <hr style="border-color: rgba(255,255,255,0.3);">
                <div class="row text-sm">
                    <div class="col-3">
                        <strong>{{ resumo_posto1.total_pac }}</strong><br>
                        <small>PAC</small>
                    </div>
                    <div class="col-3">
                        <strong>{{ resumo_posto1.total_sedex }}</strong><br>
                        <small>SEDEX</small>
                    </div>
                    <div class="col-3">
                        <strong>R$ {{ "%.2f"|format(resumo_posto1.total_pix) }}</strong><br>
                        <small>PIX</small>
                    </div>
                    <div class="col-3">
                        <strong>R$ {{ "%.2f"|format(resumo_posto1.total_dinheiro) }}</strong><br>
                        <small>Dinheiro</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card stats-card posto-2">
            <div class="card-body">
                <h5 class="card-title"><i class="bi bi-building"></i> Hotel Family</h5>
                <div class="row">
                    <div class="col-6">
                        <h3>{{ resumo_posto2.total_postagens }}</h3>
                        <small>Total de Postagens</small>
                    </div>
                    <div class="col-6">
                        <h3>R$ {{ "%.2f"|format(resumo_posto2.total_valor) }}</h3>
                        <small>Valor Total</small>
                    </div>
                </div>
                <hr style="border-color: rgba(255,255,255,0.3);">
                <div class="row text-sm">
                    <div class="col-3">
                        <strong>{{ resumo_posto2.total_pac }}</strong><br>
                        <small>PAC</small>
                    </div>
                    <div class="col-3">
                        <strong>{{ resumo_posto2.total_sedex }}</strong><br>
                        <small>SEDEX</small>
                    </div>
                    <div class="col-3">
                        <strong>R$ {{ "%.2f"|format(resumo_posto2.total_pix) }}</strong><br>
                        <small>PIX</small>
                    </div>
                    <div class="col-3">
                        <strong>R$ {{ "%.2f"|format(resumo_posto2.total_dinheiro) }}</strong><br>
                        <small>Dinheiro</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- AÃ§Ãµes RÃ¡pidas -->
<div class="row mb-4">
    <div class="col-md-4">
        <a href="/nova_postagem" class="btn btn-primary btn-lg w-100">
            <i class="bi bi-plus-circle"></i> Nova Postagem
        </a>
    </div>
    <div class="col-md-4">
        <a href="/fechamento" class="btn btn-success btn-lg w-100">
            <i class="bi bi-clipboard-check"></i> Fechamento do Dia
        </a>
    </div>
    <div class="col-md-4">
        <button class="btn btn-warning btn-lg w-100" onclick="window.print()">
            <i class="bi bi-printer"></i> Imprimir RelatÃ³rio
        </button>
    </div>
</div>

<!-- Lista de Postagens do Dia -->
<div class="card">
    <div class="card-header">
        <h5><i class="bi bi-list-ul"></i> Postagens de Hoje ({{ postagens|length }})</h5>
    </div>
    <div class="card-body">
        {% if postagens %}
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>Posto</th>
                            <th>Remetente</th>
                            <th>CÃ³digo Rastreio</th>
                            <th>Tipo</th>
                            <th>Valor</th>
                            <th>Pagamento</th>
                            <th>Data Pagamento</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for postagem in postagens %}
                        <tr>
                            <td>
                                <span class="badge bg-{{ 'primary' if postagem[2] == 1 else 'success' }}">
                                    {{ NOME_POSTO[postagem[2]] }}
                                </span>
                            </td>
                            <td>{{ postagem[3] }}</td>
                            <td><code>{{ postagem[4] }}</code></td>
                            <td>
                                <span class="badge bg-{{ 'info' if postagem[6] == 'PAC' else 'warning' }}">
                                    {{ postagem[6] }}
                                </span>
                            </td>
                            <td>R$ {{ "%.2f"|format(postagem[5]) }}</td>
                            <td>
                                <span class="badge bg-{{ 'success' if postagem[7] == 'PIX' else 'secondary' }}">
                                    {{ postagem[7] or 'Pendente' }}
                                </span>
                            </td>
                            <td>
                                {% if postagem[10] %}
                                    {{ postagem[10] | datetimeformat }}
                                {% else %}
                                    Pendente
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <div class="text-center text-muted py-4">
                <i class="bi bi-inbox" style="font-size: 3rem;"></i>
                <p class="mt-2">Nenhuma postagem registrada hoje</p>
                <a href="/nova_postagem" class="btn btn-primary">Registrar Primeira Postagem</a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
